conte_all %>% dplyr::select(`Study.Group`,  AMYG_L_ACC_L, AMYG_L_ACC_R, AMYG_R_ACC_R, AMYG_R_ACC_L, AMYG_L_PFC_L, AMYG_L_PFC_R, AMYG_R_PFC_L, AMYG_R_PFC_R, AMYG_L_PreCG_L, AMYG_L_PreCG_R, AMYG_R_PreCG_L, AMYG_R_PreCG_R, AMYG_L_SFGdor_L, AMYG_L_SFGdor_R, AMYG_R_SFGdor_L, AMYG_R_SFGdor_R,  AMYG_L_SFGmed_L,AMYG_L_SFGmed_R, AMYG_R_SFGmed_L, AMYG_R_SFGmed_R,ctqtot, cesd_avg, pss_avg, scor_abp1_psqi_global, baby_ga, baby_q2, baby_q4, baby_q6, dem_age, dem_bmi, pdqtot, peshappytot, pesunhappytot, ecr, dem_relationship, dem_race, dem_ethnicity, dem_fin_income, dem_edu_yrs, dem_ph_q6, dem_ph_q7,cesd_avg_16, pisq_5),
numeric.test='kwt', digits=2))
load('conte_mri_analysisdata_v1_2025_12_05.RData')
clean_tab<-function(tab){
aa = as.data.frame(tab)
names(aa)[1]<-'variable'
return(aa %>% mutate(variable = gsub('\\**','',gsub('&nbsp;&nbsp;&nbsp;','', variable))))
}
library(arsenal)
a<-summary(tableby(`Study.Group` ~ .,
conte_all %>% dplyr::select(`Study.Group`,  AMYG_L_ACC_L, AMYG_L_ACC_R, AMYG_R_ACC_R, AMYG_R_ACC_L, AMYG_L_PFC_L, AMYG_L_PFC_R, AMYG_R_PFC_L, AMYG_R_PFC_R, AMYG_L_PreCG_L, AMYG_L_PreCG_R, AMYG_R_PreCG_L, AMYG_R_PreCG_R, AMYG_L_SFGdor_L, AMYG_L_SFGdor_R, AMYG_R_SFGdor_L, AMYG_R_SFGdor_R,  AMYG_L_SFGmed_L,AMYG_L_SFGmed_R, AMYG_R_SFGmed_L, AMYG_R_SFGmed_R,ctqtot, cesd_avg, pss_avg, scor_abp1_psqi_global, baby_ga, baby_q2, baby_q4, baby_q6, dem_age, dem_bmi, pdqtot, peshappytot, pesunhappytot, ecr, dem_relationship, dem_race, dem_ethnicity, dem_fin_income, dem_edu_yrs, dem_ph_q6, dem_ph_q7,cesd_avg_16, pisq_5),
numeric.test='kwt', digits=2))
tab.demo = clean_tab(a) %>%
select(variable, `Total (N=59)`, everything())
predictor_variables<-c( "PMA_MRI","baby_ga","baby_q2", "baby_q4", "baby_q6", "dem_age", "dem_bmi", "dem_relationship", "dem_race", "dem_ethnicity", "dem_fin_income", "dem_edu_yrs", "dem_ph_q6", "dem_ph_q7")
outcome<-"ctqtot"
predictor_variables<-c( "PMA_MRI","baby_ga","baby_q2", "baby_q4", "baby_q6", "dem_age", "dem_bmi", "dem_relationship", "dem_race", "dem_ethnicity", "dem_fin_income", "dem_edu_yrs", "dem_ph_q6", "dem_ph_q7",
"cesd_avg_16", "pisq_5")
outcome<-"ctqtot"
ctq_cov_fstat.tab <- do.call(rbind, lapply(predictor_variables,
function(pred, out='ctqtot'){
model <- lm(as.formula(paste(out, "~", pred)), data = conte_all)
anova_results <- car::Anova(model, type = "III")
f_stat <- anova_results[pred, "F value"]
p_value <- anova_results[pred, "Pr(>F)"]
txt = paste0(round(f_stat, 3), " (", format.pval(p_value, digits = 3), ")")
return(data.frame(y=out, x=pred, CTQ.Total=txt))
}))
ctq_cov_fstat.tab
gsub('(0)','<0.001', ctq_cov_fstat.tab$CTQ.Total)
gsub('\\(0\\)','<0.001', ctq_cov_fstat.tab$CTQ.Total)
gsub('\\(0\\)','(<0.001)', ctq_cov_fstat.tab$CTQ.Total)
ctq_cov_fstat.tab$CTQ.Total=gsub('\\(0\\)','(<0.001)', ctq_cov_fstat.tab$CTQ.Total)
tab.demo
predictor_variables<-c( "ctqtot","baby_ga","baby_q2", "baby_q4", "baby_q6", "dem_age", "dem_bmi", "dem_relationship", "dem_race", "dem_ethnicity", "dem_fin_income", "dem_edu_yrs", "dem_ph_q6", "dem_ph_q7",
"cesd_avg_16", "pisq_5")
outcome<-"PMA_MRI"
predictor_variables<-c( "ctqtot","baby_ga","baby_q2", "baby_q4", "baby_q6", "dem_age", "dem_bmi", "dem_relationship", "dem_race", "dem_ethnicity", "dem_fin_income", "dem_edu_yrs", "dem_ph_q6", "dem_ph_q7",
"cesd_avg_16", "pisq_5")
outcome<-"PMA_MRI"
pma_cov_fstat.tab <- do.call(rbind, lapply(predictor_variables,
function(pred, out='ctqtot'){
model <- lm(as.formula(paste(out, "~", pred)), data = conte_all)
anova_results <- car::Anova(model, type = "III")
f_stat <- anova_results[pred, "F value"]
p_value <- anova_results[pred, "Pr(>F)"]
txt = paste0(round(f_stat, 3), " (", format.pval(p_value, digits = 3), ")")
return(data.frame(y=out, x=pred, PMA=txt))
}))
pma_cov_fstat.tab$CTQ.Total=gsub('\\(0\\)','(<0.001)', pma_cov_fstat.tab$CTQ.Total)
pma_cov_fstat.tab <- do.call(rbind, lapply(predictor_variables,
function(pred, out='PMA_MRI'){
model <- lm(as.formula(paste(out, "~", pred)), data = conte_all)
anova_results <- car::Anova(model, type = "III")
f_stat <- anova_results[pred, "F value"]
p_value <- anova_results[pred, "Pr(>F)"]
txt = paste0(round(f_stat, 3), " (", format.pval(p_value, digits = 3), ")")
return(data.frame(y=out, x=pred, PMA=txt))
}))
pma_cov_fstat.tab$PMA=gsub('\\(0\\)','(<0.001)', pma_cov_fstat.tab$PMA)
pma_cov_fstat.tab
pred=predictor_variables[1]
out='PMA_MRI'
model <- lm(as.formula(paste(out, "~", pred)), data = conte_all)
anova_results <- car::Anova(model, type = "III")
anova_results
help(pF)
help(pf)
pf(2.1331,1,57)
1-pf(2.1331,1,57)
anova(model)
anova_results
anova_results$Df
f_df <-anova_results$Df[c(2,3)]
f_stat <- anova_results[pred, "F value"]
f_df <-anova_results$Df[c(2,3)]
p_value <- anova_results[pred, "Pr(>F)"]
paste0(round(f_stat, 3), " (", format.pval(p_value, digits = 3), ")")
paste0(f_df, collapse=',')
paste0('F(', paste0(f_df, collapse=','),') ', round(f_stat, 3), " (", format.pval(p_value, digits = 3), ")")
paste0('F(', paste0(f_df, collapse=','),')=', round(f_stat, 3), " (", format.pval(p_value, digits = 3), ")")
paste0('F(', paste0(f_df, collapse=','),')=', round(f_stat, 3), ", p=", format.pval(p_value, digits = 3))
predictor_variables<-c( "PMA_MRI","baby_ga","baby_q2", "baby_q4", "baby_q6", "dem_age", "dem_bmi", "dem_relationship", "dem_race", "dem_ethnicity", "dem_fin_income", "dem_edu_yrs", "dem_ph_q6", "dem_ph_q7",
"cesd_avg_16", "pisq_5")
outcome<-"ctqtot"
ctq_cov_fstat.tab <- do.call(rbind, lapply(predictor_variables,
function(pred, out='ctqtot'){
model <- lm(as.formula(paste(out, "~", pred)), data = conte_all)
anova_results <- car::Anova(model, type = "III")
f_stat <- anova_results[pred, "F value"]
p_value <- anova_results[pred, "Pr(>F)"]
txt = paste0('F(', paste0(f_df, collapse=','),')=', round(f_stat, 3), ", p=", format.pval(p_value, digits = 3))
return(data.frame(y=out, x=pred, CTQ.Total=txt))
}))
ctq_cov_fstat.tab$CTQ.Total=gsub('\\(0\\)','(<0.001)', ctq_cov_fstat.tab$CTQ.Total)
ctq_cov_fstat.tab
predictor_variables<-c( "ctqtot","baby_ga","baby_q2", "baby_q4", "baby_q6", "dem_age", "dem_bmi", "dem_relationship", "dem_race", "dem_ethnicity", "dem_fin_income", "dem_edu_yrs", "dem_ph_q6", "dem_ph_q7",
"cesd_avg_16", "pisq_5")
pma_cov_fstat.tab <- do.call(rbind, lapply(predictor_variables,
function(pred, out='PMA_MRI'){
model <- lm(as.formula(paste(out, "~", pred)), data = conte_all)
anova_results <- car::Anova(model, type = "III")
f_stat <- anova_results[pred, "F value"]
f_df <-anova_results$Df[c(2,3)]
p_value <- anova_results[pred, "Pr(>F)"]
txt = paste0('F(', paste0(f_df, collapse=','),')=', round(f_stat, 3), ", p=", format.pval(p_value, digits = 3))
return(data.frame(y=out, x=pred, PMA=txt))
}))
pma_cov_fstat.tab$PMA=gsub('\\(0\\)','(<0.001)', pma_cov_fstat.tab$PMA)
pma_cov_fstat.tab
fc_measures<-c("AMYG_L_ACC_L", "AMYG_L_ACC_R", "AMYG_R_ACC_R", "AMYG_R_ACC_L", "AMYG_L_PFC_L", "AMYG_L_PFC_R", "AMYG_R_PFC_L", "AMYG_R_PFC_R","AMYG_L_PreCG_L", "AMYG_L_PreCG_R", "AMYG_R_PreCG_L", "AMYG_R_PreCG_R","AMYG_L_SFGdor_L", "AMYG_L_SFGdor_R", "AMYG_R_SFGdor_L", "AMYG_R_SFGdor_R",  "AMYG_L_SFGmed_L","AMYG_L_SFGmed_R", "AMYG_R_SFGmed_L", "AMYG_R_SFGmed_R")
med_vars<-c("cesd_avg", "pss_avg", "scor_abp1_psqi_global","ecr", "pdqtot", "peshappytot", "pesunhappytot")
x_variables<-"ctqtot"
#ctq_cov_fstat.tab <-
association.tab <- do.call(rbind, lapply(c(x_variables,med_vars), function(med){
do.call(rbind, lapply(fc_measures,
function(x, y=med){
tmp = conte_all %>% select(y,x)
#                      tmp[,1] = scale(tmp[,1])
#                      tmp[,2] = scale(tmp[,2])
model <- lm(as.formula(paste(y, "~", x)), data = tmp)
model_summary <- summary(model)
# Extract coefficient and p-value for the predictor
estimate <- coef(model_summary)[x, "Estimate"]
p_value <- coef(model_summary)[x, "Pr(>|t|)"]
txt = paste0(round(estimate, 3), " (", format.pval(p_value, digits = 3), ")")
return(data.frame(y=y, x=x, stat=txt))
}))})) %>%
dcast(., x ~ y, value.var='stat') %>%
select(x, ctqtot, everything())
association.tab2 <- do.call(rbind, lapply(c(x_variables,med_vars), function(med){
do.call(rbind, lapply(fc_measures,
function(y, x=med){
tmp = conte_all %>% select(y,x)
tmp[,1] = scale(tmp[,1])
tmp[,2] = scale(tmp[,2])
model <- lm(as.formula(paste(y, "~", x)), data = tmp)
model_summary <- summary(model)
# Extract coefficient and p-value for the predictor
estimate <- coef(model_summary)[x, "Estimate"]
p_value <- coef(model_summary)[x, "Pr(>|t|)"]
txt = paste0(round(estimate, 3), " (", format.pval(p_value, digits = 3), ")")
return(data.frame(y=y, x=x, stat=txt))
}))})) %>%
dcast(., y ~ x, value.var='stat') %>%
select(y, ctqtot, everything())
association.tab
names(conte_all)
med_vars<-c("PMA_MRI","baby_ga","cesd_avg", "pss_avg", "scor_abp1_psqi_global","ecr", "pdqtot", "peshappytot", "pesunhappytot")
x_variables<-"ctqtot"
#ctq_cov_fstat.tab <-
association.tab <- do.call(rbind, lapply(c(x_variables,med_vars), function(med){
do.call(rbind, lapply(fc_measures,
function(x, y=med){
tmp = conte_all %>% select(y,x)
#                      tmp[,1] = scale(tmp[,1])
#                      tmp[,2] = scale(tmp[,2])
model <- lm(as.formula(paste(y, "~", x)), data = tmp)
model_summary <- summary(model)
# Extract coefficient and p-value for the predictor
estimate <- coef(model_summary)[x, "Estimate"]
p_value <- coef(model_summary)[x, "Pr(>|t|)"]
txt = paste0(round(estimate, 3), " (", format.pval(p_value, digits = 3), ")")
return(data.frame(y=y, x=x, stat=txt))
}))})) %>%
dcast(., x ~ y, value.var='stat') %>%
select(x, ctqtot, everything())
association.tab
med_vars<-c("PMA_MRI","baby_ga","cesd_avg", "pss_avg", "scor_abp1_psqi_global","ecr", "pdqtot", "peshappytot", "pesunhappytot")
x_variables<-"ctqtot"
#ctq_cov_fstat.tab <-
association.tab <- do.call(rbind, lapply(c(x_variables,med_vars), function(med){
do.call(rbind, lapply(fc_measures,
function(x, y=med){
tmp = conte_all %>% select(y,x)
#                      tmp[,1] = scale(tmp[,1])
#                      tmp[,2] = scale(tmp[,2])
model <- lm(as.formula(paste(y, "~", x)), data = tmp)
model_summary <- summary(model)
# Extract coefficient and p-value for the predictor
estimate <- coef(model_summary)[x, "Estimate"]
p_value <- coef(model_summary)[x, "Pr(>|t|)"]
txt = paste0(round(estimate, 3), " (", format.pval(p_value, digits = 3), ")")
return(data.frame(y=y, x=x, stat=txt))
}))})) %>%
dcast(., x ~ y, value.var='stat') %>%
select(x, ctqtot, everything())
association.tab2 <- do.call(rbind, lapply(c(x_variables,med_vars), function(med){
do.call(rbind, lapply(fc_measures,
function(y, x=med){
tmp = conte_all %>% select(y,x)
tmp[,1] = scale(tmp[,1])
tmp[,2] = scale(tmp[,2])
model <- lm(as.formula(paste(y, "~", x)), data = tmp)
model_summary <- summary(model)
# Extract coefficient and p-value for the predictor
estimate <- coef(model_summary)[x, "Estimate"]
p_value <- coef(model_summary)[x, "Pr(>|t|)"]
txt = paste0(round(estimate, 3), " (", format.pval(p_value, digits = 3), ")")
return(data.frame(y=y, x=x, stat=txt))
}))})) %>%
dcast(., y ~ x, value.var='stat') %>%
select(y, ctqtot, everything())
association.tab
#ctq_cov_fstat.tab <-
association.tab <- do.call(rbind, lapply(c(x_variables,med_vars), function(med){
do.call(rbind, lapply(fc_measures,
function(x, y=med){
tmp = conte_all %>% select(y,x)
#                      tmp[,1] = scale(tmp[,1])
#                      tmp[,2] = scale(tmp[,2])
model <- lm(as.formula(paste(y, "~", x)), data = tmp)
model_summary <- summary(model)
# Extract coefficient and p-value for the predictor
estimate <- coef(model_summary)[x, "Estimate"]
p_value <- coef(model_summary)[x, "Pr(>|t|)"]
txt = paste0(round(estimate, 3), " (", format.pval(p_value, digits = 3), ")")
return(data.frame(y=y, x=x, stat=txt))
}))})) %>%
dcast(., x ~ y, value.var='stat') %>%
select(x, ctqtot, PMA_MRI, baby_ga, everything())
association.tab2
association.tab2 <- do.call(rbind, lapply(c(x_variables,med_vars), function(med){
do.call(rbind, lapply(fc_measures,
function(y, x=med){
tmp = conte_all %>% select(y,x)
tmp[,1] = scale(tmp[,1])
tmp[,2] = scale(tmp[,2])
model <- lm(as.formula(paste(y, "~", x)), data = tmp)
model_summary <- summary(model)
# Extract coefficient and p-value for the predictor
estimate <- coef(model_summary)[x, "Estimate"]
p_value <- coef(model_summary)[x, "Pr(>|t|)"]
txt = paste0(round(estimate, 3), " (", format.pval(p_value, digits = 3), ")")
return(data.frame(y=y, x=x, stat=txt))
}))})) %>%
dcast(., y ~ x, value.var='stat') %>%
select(y, ctqtot, PMA_MRI, baby_ga, everything())
head(pma_cov_fstat.tab)
ctq_cov_fstat.tab
is.numeric(conte_all[,pred])
pred
conte_all[,pred]
is.numeric(unlist(conte_all[,pred]))
pred='pisq_5'
is.numeric(unlist(conte_all[,pred]))
cor.test(conte_all[,c(out,pred)])
conte_all[,c(out,pred)]
pred='baby_ga'
cor.test(conte_all[,c(out,pred)])
out='PMA_MRI'
cor.test(conte_all[,c(out,pred)])
conte_all[,c(out,pred)]
data.frame(conte_all[,c(out,pred)])
cor.test(data.frame(conte_all[,c(out,pred)]))
cor.test(conte_all[,out], conte_all[,pred])
cor.test(unlist(conte_all[,out]), unlist(conte_all[,pred]))
help9cor.test
help("cor.test")
cor(unlist(conte_all[,out]), unlist(conte_all[,pred]))
round(cor(unlist(conte_all[,out]), unlist(conte_all[,pred])),3)
predictor_variables<-c( "ctqtot","baby_ga","baby_q2", "baby_q4", "baby_q6", "dem_age", "dem_bmi", "dem_relationship", "dem_race", "dem_ethnicity", "dem_fin_income", "dem_edu_yrs", "dem_ph_q6", "dem_ph_q7",
"cesd_avg_16", "pisq_5")
pma_cov_fstat.tab <- do.call(rbind, lapply(predictor_variables,
function(pred, out='PMA_MRI'){
model <- lm(as.formula(paste(out, "~", pred)), data = conte_all)
anova_results <- car::Anova(model, type = "III")
f_stat <- anova_results[pred, "F value"]
f_df <-anova_results$Df[c(2,3)]
p_value <- anova_results[pred, "Pr(>F)"]
txt = paste0('F(', paste0(f_df, collapse=','),')=', round(f_stat, 3), ", p=", format.pval(p_value, digits = 3))
if(is.numeric(unlist(conte_all[,pred]))){
text=paste(txt, ', r=',round(cor(unlist(conte_all[,out]), unlist(conte_all[,pred])),3))
}
return(data.frame(y=out, x=pred, PMA=txt))
}))
pma_cov_fstat.tab$PMA=gsub('\\(0\\)','(<0.001)', pma_cov_fstat.tab$PMA)
pma_cov_fstat.tab
pma_cov_fstat.tab <- do.call(rbind, lapply(predictor_variables,
function(pred, out='PMA_MRI'){
model <- lm(as.formula(paste(out, "~", pred)), data = conte_all)
anova_results <- car::Anova(model, type = "III")
f_stat <- anova_results[pred, "F value"]
f_df <-anova_results$Df[c(2,3)]
p_value <- anova_results[pred, "Pr(>F)"]
txt = paste0('F(', paste0(f_df, collapse=','),')=', round(f_stat, 3), ", p=", format.pval(p_value, digits = 3))
if(is.numeric(unlist(conte_all[,pred]))){
txt=paste(txt, ', r=',round(cor(unlist(conte_all[,out]), unlist(conte_all[,pred])),3))
}
return(data.frame(y=out, x=pred, PMA=txt))
}))
pma_cov_fstat.tab$PMA=gsub('\\(0\\)','(<0.001)', pma_cov_fstat.tab$PMA)
pma_cov_fstat.tab
pma_cov_fstat.tab <- do.call(rbind, lapply(predictor_variables,
function(pred, out='PMA_MRI'){
model <- lm(as.formula(paste(out, "~", pred)), data = conte_all)
anova_results <- car::Anova(model, type = "III")
f_stat <- anova_results[pred, "F value"]
f_df <-anova_results$Df[c(2,3)]
p_value <- anova_results[pred, "Pr(>F)"]
txt = paste0('F(', paste0(f_df, collapse=','),')=', round(f_stat, 3), ", p=", format.pval(p_value, digits = 3))
if(is.numeric(unlist(conte_all[,pred]))){
txt=paste(txt, ', r=',round(cor(unlist(conte_all[,out]), unlist(conte_all[,pred])),3), sep='')
}
return(data.frame(y=out, x=pred, PMA=txt))
}))
pma_cov_fstat.tab$PMA=gsub('\\(0\\)','(<0.001)', pma_cov_fstat.tab$PMA)
pma_cov_fstat.tab
predictor_variables<-c( "PMA_MRI","baby_ga","baby_q2", "baby_q4", "baby_q6", "dem_age", "dem_bmi", "dem_relationship", "dem_race", "dem_ethnicity", "dem_fin_income", "dem_edu_yrs", "dem_ph_q6", "dem_ph_q7",
"cesd_avg_16", "pisq_5")
outcome<-"ctqtot"
ctq_cov_fstat.tab <- do.call(rbind, lapply(predictor_variables,
function(pred, out='ctqtot'){
model <- lm(as.formula(paste(out, "~", pred)), data = conte_all)
anova_results <- car::Anova(model, type = "III")
f_stat <- anova_results[pred, "F value"]
p_value <- anova_results[pred, "Pr(>F)"]
txt = paste0('F(', paste0(f_df, collapse=','),')=', round(f_stat, 3), ", p=", format.pval(p_value, digits = 3))
if(is.numeric(unlist(conte_all[,pred]))){
txt=paste(txt, ', r=',round(cor(unlist(conte_all[,out]), unlist(conte_all[,pred])),3), sep='')
}
return(data.frame(y=out, x=pred, CTQ.Total=txt))
}))
ctq_cov_fstat.tab$CTQ.Total=gsub('\\(0\\)','(<0.001)', ctq_cov_fstat.tab$CTQ.Total)
ctq_cov_fstat.tab
association.tab2
#ctq_cov_fstat.tab <-
association.tab <- do.call(rbind, lapply(c(x_variables,med_vars), function(med){
do.call(rbind, lapply(fc_measures,
function(x, y=med){
tmp = conte_all %>% select(y,x)
tmp[,1] = scale(tmp[,1])
tmp[,2] = scale(tmp[,2])
model <- lm(as.formula(paste(y, "~", x)), data = tmp)
model_summary <- summary(model)
# Extract coefficient and p-value for the predictor
estimate <- coef(model_summary)[x, "Estimate"]
p_value <- coef(model_summary)[x, "Pr(>|t|)"]
txt = paste0(round(estimate, 3), " (", format.pval(p_value, digits = 3), ")")
return(data.frame(y=y, x=x, stat=txt))
}))})) %>%
dcast(., x ~ y, value.var='stat') %>%
select(x, ctqtot, PMA_MRI, baby_ga, everything())
association.tab2 <- do.call(rbind, lapply(c(x_variables,med_vars), function(med){
do.call(rbind, lapply(fc_measures,
function(y, x=med){
tmp = conte_all %>% select(y,x)
tmp[,1] = scale(tmp[,1])
tmp[,2] = scale(tmp[,2])
model <- lm(as.formula(paste(y, "~", x)), data = tmp)
model_summary <- summary(model)
# Extract coefficient and p-value for the predictor
estimate <- coef(model_summary)[x, "Estimate"]
p_value <- coef(model_summary)[x, "Pr(>|t|)"]
txt = paste0(round(estimate, 3), " (", format.pval(p_value, digits = 3), ")")
return(data.frame(y=y, x=x, stat=txt))
}))})) %>%
dcast(., y ~ x, value.var='stat') %>%
select(y, ctqtot, PMA_MRI, baby_ga, everything())
association.tab2
ctq_med_reg.tab2
ctq_med_reg.tab2 <- do.call(rbind, lapply(med_vars,
function(y,x='ctqtot'){
tmp = conte_all %>% select(x,y)
tmp[,1] = scale(tmp[,1])
tmp[,2] = scale(tmp[,2])
model <- lm(as.formula(paste(y, "~", x)), data = tmp)
model_summary <- summary(model)
# Extract coefficient and p-value for the predictor
estimate <- coef(model_summary)[x, "Estimate"]
p_value <- coef(model_summary)[x, "Pr(>|t|)"]
txt = paste0(round(estimate, 3), " (", ifelse(p_value<0.001, '<0.001',format.pval(p_value, digits = 3)), ")")
return(data.frame(y=y, CTQ.Total=txt))
}))
ctq_med_reg.tab2
ctq_med_reg.tab2 <-
ctq_med_reg.tab2 <-
lapply(c('ctqtot', 'PMA_MRI', 'baby_ga'), function(xvar){
do.call(rbind, lapply(med_vars,
function(y,x=xvar){
tmp = conte_all %>% select(x,y)
tmp[,1] = scale(tmp[,1])
tmp[,2] = scale(tmp[,2])
model <- lm(as.formula(paste(y, "~", x)), data = tmp)
model_summary <- summary(model)
# Extract coefficient and p-value for the predictor
estimate <- coef(model_summary)[x, "Estimate"]
p_value <- coef(model_summary)[x, "Pr(>|t|)"]
txt = paste0(round(estimate, 3), " (", ifelse(p_value<0.001, '<0.001',format.pval(p_value, digits = 3)), ")")
return(data.frame(y=y, var=txt, xvar=xvar))
}))
})
names(conte_all)
ctq_med_reg.tab2 <-
lapply(c('ctqtot', 'PMA_MRI', 'baby_ga'), function(xvar){
do.call(rbind, lapply(med_vars,
function(y,x=xvar){
tmp = conte_all %>% select(x,y)
tmp[,1] = scale(tmp[,1])
tmp[,2] = scale(tmp[,2])
model <- lm(as.formula(paste(y, "~", x)), data = tmp)
model_summary <- summary(model)
# Extract coefficient and p-value for the predictor
estimate <- coef(model_summary)[x, "Estimate"]
p_value <- coef(model_summary)[x, "Pr(>|t|)"]
txt = paste0(round(estimate, 3), " (", ifelse(p_value<0.001, '<0.001',format.pval(p_value, digits = 3)), ")")
return(data.frame(y=y, var=txt, xvar=xvar))
}))
})
conte_all %>% select(med_vars[1],'ctqtot')
ctq_med_reg.tab2 <-
lapply(c('ctqtot', 'PMA_MRI', 'baby_ga'), function(xvar){
do.call(rbind, lapply(med_vars,
function(y,x=xvar){
tmp = conte_all %>% select(x,y) %>% na.omit(.)
tmp[,1] = scale(tmp[,1])
tmp[,2] = scale(tmp[,2])
model <- lm(as.formula(paste(y, "~", x)), data = tmp)
model_summary <- summary(model)
# Extract coefficient and p-value for the predictor
estimate <- coef(model_summary)[x, "Estimate"]
p_value <- coef(model_summary)[x, "Pr(>|t|)"]
txt = paste0(round(estimate, 3), " (", ifelse(p_value<0.001, '<0.001',format.pval(p_value, digits = 3)), ")")
return(data.frame(y=y, var=txt, xvar=xvar))
}))
})
med_vars<-c("cesd_avg", "pss_avg", "scor_abp1_psqi_global","ecr", "pdqtot", "peshappytot", "pesunhappytot")
x_variables<-"ctqtot"
ctq_med_reg.tab <- do.call(rbind, lapply(med_vars,
function(x, out='ctqtot'){
model <- lm(as.formula(paste(out, "~", x)), data = conte_all)
#                      tmp[,1] = scale(tmp[,1])
#                      tmp[,2] = scale(tmp[,2])
model_summary <- summary(model)
# Extract coefficient and p-value for the predictor
estimate <- coef(model_summary)[x, "Estimate"]
p_value <- coef(model_summary)[x, "Pr(>|t|)"]
txt = paste0(round(estimate, 3), " (", ifelse(p_value<0.001, '<0.001',format.pval(p_value, digits = 3)), ")")
return(data.frame(y=out, x=x, CTQ.Total=txt))
}))
ctq_med_reg.tab2 <-
lapply(c('ctqtot', 'PMA_MRI', 'baby_ga'), function(xvar){
do.call(rbind, lapply(med_vars,
function(y,x=xvar){
tmp = conte_all %>% select(x,y) %>% na.omit(.)
tmp[,1] = scale(tmp[,1])
tmp[,2] = scale(tmp[,2])
model <- lm(as.formula(paste(y, "~", x)), data = tmp)
model_summary <- summary(model)
# Extract coefficient and p-value for the predictor
estimate <- coef(model_summary)[x, "Estimate"]
p_value <- coef(model_summary)[x, "Pr(>|t|)"]
txt = paste0(round(estimate, 3), " (", ifelse(p_value<0.001, '<0.001',format.pval(p_value, digits = 3)), ")")
return(data.frame(y=y, var=txt, xvar=xvar))
}))
})
ctq_med_reg.tab2
ctq_med_reg.tab2 <- do.call(rbind,
lapply(c('ctqtot', 'PMA_MRI', 'baby_ga'), function(xvar){
do.call(rbind, lapply(med_vars,
function(y,x=xvar){
tmp = conte_all %>% select(x,y) %>% na.omit(.)
tmp[,1] = scale(tmp[,1])
tmp[,2] = scale(tmp[,2])
model <- lm(as.formula(paste(y, "~", x)), data = tmp)
model_summary <- summary(model)
# Extract coefficient and p-value for the predictor
estimate <- coef(model_summary)[x, "Estimate"]
p_value <- coef(model_summary)[x, "Pr(>|t|)"]
txt = paste0(round(estimate, 3), " (", ifelse(p_value<0.001, '<0.001',format.pval(p_value, digits = 3)), ")")
return(data.frame(y=y, var=txt, xvar=xvar))
}))
})) %>%
dcast(y ~ xvar, value.var='var')
ctq_med_reg.tab2
med_vars<-c("cesd_avg", "pss_avg", "scor_abp1_psqi_global","ecr", "pdqtot", "peshappytot", "pesunhappytot")
x_variables<-"ctqtot"
ctq_med_reg.tab <- do.call(rbind, lapply(med_vars,
function(x, out='ctqtot'){
model <- lm(as.formula(paste(out, "~", x)), data = conte_all)
#                      tmp[,1] = scale(tmp[,1])
#                      tmp[,2] = scale(tmp[,2])
model_summary <- summary(model)
# Extract coefficient and p-value for the predictor
estimate <- coef(model_summary)[x, "Estimate"]
p_value <- coef(model_summary)[x, "Pr(>|t|)"]
txt = paste0(round(estimate, 3), " (", ifelse(p_value<0.001, '<0.001',format.pval(p_value, digits = 3)), ")")
return(data.frame(y=out, x=x, CTQ.Total=txt))
}))
ctq_med_reg.tab2 <- do.call(rbind,
lapply(c('ctqtot', 'PMA_MRI', 'baby_ga'), function(xvar){
do.call(rbind, lapply(med_vars,
function(y,x=xvar){
tmp = conte_all %>% select(x,y)
tmp[,1] = scale(tmp[,1])
tmp[,2] = scale(tmp[,2])
model <- lm(as.formula(paste(y, "~", x)), data = tmp)
model_summary <- summary(model)
# Extract coefficient and p-value for the predictor
estimate <- coef(model_summary)[x, "Estimate"]
p_value <- coef(model_summary)[x, "Pr(>|t|)"]
txt = paste0(round(estimate, 3), " (", ifelse(p_value<0.001, '<0.001',format.pval(p_value, digits = 3)), ")")
return(data.frame(y=y, var=txt, xvar=xvar))
}))
})) %>%
mutate(y=factor(y, levels=med_vars)) %>%
dcast(y ~ xvar, value.var='var') %>%
select(y, ctqtot, PMA_MRI, baby_ga)
ctq_med_reg.tab2
load('Conte_MRI_Final_Report_v1_2025_12_05.RData')
rm(list=ls())
load('Conte_MRI_Final_Report_v1_2025_12_05.RData')
